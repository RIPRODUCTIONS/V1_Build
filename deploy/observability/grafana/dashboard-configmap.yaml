apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-self-heal
  namespace: builder
  labels:
    grafana_dashboard: "1"
data:
  dashboard_self_heal.json: |
    {"title":"Self-Healing Overview","panels":[{"type":"graph","title":"FastAPI p95","targets":[{"expr":"histogram_quantile(0.95, sum(rate(fastapi_request_duration_seconds_bucket[5m])) by (le))"}]},{"type":"graph","title":"Celery Success/Failure","targets":[{"expr":"sum(rate(celery_tasks_succeeded_total[5m]))"},{"expr":"sum(rate(celery_tasks_failed_total[5m]))"}]},{"type":"graph","title":"LLM Latency p95","targets":[{"expr":"histogram_quantile(0.95, sum(rate(llm_request_latency_seconds_bucket[5m])) by (le))"}]},{"type":"graph","title":"HPA Replicas","targets":[{"expr":"kube_deployment_status_replicas{deployment=\"api\"}"}]},{"type":"graph","title":"Pod Restarts","targets":[{"expr":"sum(rate(kube_pod_container_status_restarts_total[5m])) by (pod)"}]}]}
